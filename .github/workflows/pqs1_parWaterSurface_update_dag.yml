name: pqs1-parWaterSurface-update-dag
on:
  push:
    branches:
      - 'master'
    paths:
      - 'pipe/pqs1/*.yaml'
      - 'pipe/pqs1/pipe_list_pqs1.txt'
      - 'pipe/parWaterSurface/*.yaml'
      - 'pipe/parWaterSurface/pipe_list_parWaterSurface.txt'
  workflow_dispatch: {} # Allows trigger of workflow from web interface
jobs:
  update-pipelines:
    runs-on: arc-neon-gke
    #runs-on: ubuntu-latest 
    env:
      PACHD_ADDRESS: grpcs://pachd.nonprod.gcp.neoninternal.org:443
      PACH_TOKEN: ${{ secrets.PipelineRobotToken }}
      PATHS: 'pipe/pqs1,pipe/parWaterSurface' # Separate multiple with comma (e.g. 'pipe/pqs1,pipe/parWaterSurface'). Order matters.
      TRANSACTION: True
    steps:
      - uses: actions/checkout@v4
      - run: ls -la
      
      - uses: actions/setup-python@v3
        with:
          python-version: '3.10' # Version range or exact version of a Python version to use, using SemVer's version range syntax
          cache: 'pip'
      - run: pip install -r .github/workflow_scripts/update_dag_pipelines/requirements.txt
      - run: python3 -u .github/workflow_scripts/update_dag_pipelines/update_dag_pipelines.py
